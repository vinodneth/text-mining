setwd("C:/Users/vinod.nethilath/OneDrive - Accenture/TextMining/text-mining")
#Set Options
options(stringsAsFactors=F) ## default setting
Sys.setlocale('LC_ALL','C')
library(stringi)
library(stringr)
library(qdap)
library(tm)
library(ggplot2)
library(ggthemes)
##library(igraph)
library(wordcloud)
##library(plotrix)
bos.airbnb<-read.csv('bos_airbnb_1k.csv')
bos.pol<-polarity(bos.airbnb$comments)
ggplot(bos.pol$all, aes(x=polarity, y=..density..)) + theme_gdocs() + geom_histogram(binwidth=.25, fill="darkred",colour="grey60", size=.2) + geom_density(size=.75)
bos.airbnb$polarity<-scale(bos.pol$all$polarity)
pos.comments<-subset(bos.airbnb$comments, bos.airbnb$polarity>0)
neg.comments<-subset(bos.airbnb$comments, bos.airbnb$polarity<0)
pos.terms<-paste(pos.comments,collapse = " ")
neg.terms<-paste(neg.comments,collapse = " ")
all.terms<-c(pos.terms,neg.terms)
all.corpus<-VCorpus(VectorSource(all.terms))
all.tdm<-TermDocumentMatrix(all.corpus,
control=list(weighting=weightTfIdf, removePunctuation = TRUE,stopwords=stopwords(kind='en')))
all.tdm.m<-as.matrix(all.tdm)
colnames(all.tdm.m)<-c('positive','negative')
comparison.cloud(all.tdm.m, max.words=100, colors=c('darkgreen','darkred'))
